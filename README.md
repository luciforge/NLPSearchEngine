# NLPSearchEngine
# Semantic Search and Ranking System

## Overview

This project implements a **Semantic Search and Ranking System** that leverages **FAISS** (Facebook AI Similarity Search) for efficient nearest neighbor search on embeddings generated by **Sentence Transformers**. The system is designed to retrieve and rank e-commerce products based on metadata, reviews, and user queries, incorporating sentiment analysis and keyword extraction for enhanced ranking and insights.

## Features

- **Semantic Search**: Uses FAISS for fast and scalable similarity searches.
- **Ranking System**: Combines metadata, review relevance, ratings, and sentiment impact to rank products.
- **Keyword Extraction**: Highlights keywords and phrases most relevant to user queries.
- **Sentiment Analysis**: Evaluates customer sentiment in reviews to adjust rankings.
- **Visualizations**: Provides insights into search results, ranking comparisons, and sentiment impact.

## Files and Directories

### Source Code

- **`data_retrieval.py`**:
  - Handles data loading, preprocessing, and embedding generation.
  - Saves cleaned metadata and aggregated reviews.
- **`index.py`**:
  - Builds, saves, and loads FAISS indices for metadata and reviews.
- **`semantic_retrieval.py`**:
  - Performs semantic retrieval and ranking.
  - Incorporates sentiment analysis and keyword extraction.
  - Generates visualizations of search results and ranking.
- **`visualize.py`**:
  - Contains functions to plot FAISS search results, ranking comparisons, and sentiment impact.

### Additional Files

- **`requirements.txt`**: Lists all required Python dependencies.
- **Images**:
  - : Bar chart for FAISS search distances.
  - : Bar chart comparing original vs. weighted scores.
  - : Scatter plot showing sentiment's impact on rankings.

### Directories

- **`data/`**: Stores the e-commerce dataset and SQLite database.
- **`models/`**: Stores embeddings and FAISS indices.
- **`output/`**: Stores cleaned data and aggregated reviews.

## Installation

### Prerequisites

- Python 3.8+

### Steps

1. Clone the repository:
   ```bash
   git clone https://github.com/luciforge/NLPSearchEngine
   cd NLPSearchEngine
   ```
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
3. Prepare data:
   - Place the SQLite database in the `data/` directory.
   - Run `data_retrieval.py` to clean data and generate embeddings.
   ```bash
   python data_retrieval.py
   ```
4. Build FAISS indices:
   ```bash
   python index.py
   ```

## Usage

1. Start semantic retrieval:
   ```bash
   python semantic_retrieval.py
   ```
2. Enter a search query when prompted and view the ranked results.
3. Generated visualizations include:
   - FAISS search distances (`distance_match.png`)
   - Ranking comparison (`ranking_comparisons.png`)
   - Sentiment impact on rankings (`sentiment_analysis.png`)

## Visualizations

- **FAISS Search Results**: Displays the similarity distances for top-K results. ![FAISS Search Results](distance_match.png)
- **Ranking Comparison**: Compares scores before and after applying weights. ![Ranking Comparison](ranking_comparisons.png)
- **Sentiment Impact**: Shows how sentiment affects the ranking process. ![Sentiment Impact](sentiment_analysis.png)

## Technologies Used

- **FAISS**: For similarity search.
- **Sentence Transformers**: For embedding generation.
- **NLTK**: For sentiment analysis.
- **Matplotlib**: For visualizations.

## Dependencies

Refer to `requirements.txt` for the full list of dependencies:

- `matplotlib`
- `numpy`
- `pandas`
- `tqdm`
- `sentence-transformers`
- `faiss-cpu`
- `spacy`
- `nltk`
- `scikit-learn`
- `huggingface_hub`

## Acknowledgments

- FAISS and Sentence Transformers for embedding and search.
- NLTK and spaCy for sentiment analysis and NLP.

## License

This project is licensed under the MIT License.
